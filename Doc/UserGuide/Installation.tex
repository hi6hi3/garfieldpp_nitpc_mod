
\section{Installation}

The source code is hosted on a GitLab\footnote{https://gitlab.cern.ch/help/gitlab-basics/start-using-git.md} repository,
\url{https://gitlab.cern.ch/garfield/garfieldpp}.

The following instructions describe how to download 
and build Garfield++ from source. 
\begin{itemize}
  \item
  Make sure that ROOT is installed. For installation instructions 
  see \url{https://root.cern.ch/building-root} or
  \url{https://root.cern.ch/downloading-root}.
  \item
  Define an environment variable \texttt{GARFIELD\_HOME} 
  pointing to the directory where the Garfield++ classes 
  are to be located.
  In the following, we assume that we want to install Garfield 
  in a directory \texttt{/home/mydir/garfield}.
  If you are using bash, type
  \begin{lstlisting}
export GARFIELD_HOME=/home/mydir/garfield
  \end{lstlisting} 
  (replace \texttt{/home/mydir/garfield} by the path of your choice).
  
  For (t)csh-type shells, type
  \begin{lstlisting}
setenv GARFIELD_HOME /home/mydir/garfield
  \end{lstlisting}
  Include the above lines also in the \texttt{.bashrc} 
  (or \texttt{.cshrc}) file in your home directory. 
  If unsure which shell you are using, 
  type \texttt{echo \${SHELL}}.
  \item
  Download the code from the repository, either 
  using SSH access\footnote{See \url{https://gitlab.cern.ch/help/gitlab-basics/create-your-ssh-keys.md}
for instructions how to create and upload the SSH keys for gitlab.} 
  \begin{lstlisting}
git clone ssh://git@gitlab.cern.ch:7999/garfield/garfieldpp.git $GARFIELD_HOME
  \end{lstlisting}
  or HTTPS access
  \begin{lstlisting}
git clone https://gitlab.cern.ch/garfield/garfieldpp.git $GARFIELD_HOME
  \end{lstlisting}
  \item
  Change to the \texttt{\${GARFIELD\_HOME}} directory 
  (\texttt{cd \$GARFIELD\_HOME}).
  \item
  There are two options for building the library: (1) using directly the 
  \texttt{makefile} in \texttt{\${GARFIELD\_HOME}}, or (2) using CMake.
  \begin{enumerate}
  \item
  \begin{itemize}
  \item 
  If necessary, adapt the \texttt{makefile} according 
  to your configuration. 
  By default, \texttt{gfortran} is used as Fortran compiler. 
  In order to use a different compiler 
  you can modify the definition of the variable \texttt{\$FC} in the 
  \texttt{makefile} accordingly.
  \item
  Compile the classes by giving the command \texttt{make}.
  \end{itemize}
  \item
  \begin{itemize}
  \item
  Create a build directory and make it your work directory, \textit{e.\,g.}
  \begin{lstlisting}
mkdir $GARFIELD_HOME/build; cd $GARFIELD_HOME/build).
  \end{lstlisting}
  \item
  Type \texttt{cmake \$GARFIELD\_HOME}.
  \item
  Alternatively, if you want to switch on debugging and switch off optimisation, type 
  \begin{lstlisting}
cmake -DCMAKE_BUILD_TYPE=Debug $GARFIELD_HOME)
  \end{lstlisting}
  \item
  Type \texttt{make}, followed by \texttt{make install}.
  \item
  Delete the build folder.
  \end{itemize}
  \end{enumerate}
  \item
  Heed requires an environment variable \texttt{HEED\_DATABASE}
  to be defined.
  \begin{lstlisting}
export HEED_DATABASE=$GARFIELD_HOME/Heed/heed++/database/
  \end{lstlisting}
  Add this line also to your \texttt{.bashrc}/\texttt{.cshrc} as well.
\end{itemize}

After the initial download,
\begin{lstlisting}
git pull
\end{lstlisting}
followed by \texttt{make} 
(in case of trouble: try \texttt{make clean; make}),
can be used for downloading the latest version of the code 
from the repository.

%\subsection{GarfRoot}
%
%The Garfield++ classes can be used interactively within the ROOT shell.
%

